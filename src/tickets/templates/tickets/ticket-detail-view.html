{% extends '../base/base.html' %}
{% load static %}
{% block head_title %}{{ issue|title }}{% endblock %}
{% block css %}
	<link rel="stylesheet" href="{% static 'tickets/css/tickets.css' %}"/>
	<link rel="stylesheet" href="{% static 'css/forms.css' %}"/>
{% endblock %}
{% block content %}
	<h1 class="callout">{{ issue|title }}</h1>
	<div class="ui container">
		{% include 'tickets/partials/ticket-details-preview-item.html' %}

		{% if request.user == object.user %}
			<a href="{% url 'tickets:ticket-update-view' id=object.id slug=object.slug %}" class="ui button tiny submit green">Edit Issue</a>
			<button id="ticket-delete-btn" class="ui button tiny submit red">Delete Issue</button>
		{% endif %}
	</div>

	<div class="ui container mv3">
		<!-- reply form -->
		<div id="comment-reply-form" class="mv3">
			<h3 id="number-of-comments" class="ui container horizontal divider header">
			  <i class="comment icon"></i> Comments 0
			</h3>
			<form id="comment-reply-form" class="all-forms">
				<label class="pl0 fwsemibold" for="comment-reply">
					<i class="paper plane icon"></i> Leave a Reply. <span class="pl2">Characters Left: <span id="comment-characters-left">500</span></span>
				</label>
				<textarea class="mv1" id="comment-reply" rows="4" maxlength="500" required></textarea>
				<button class="ui button submit black">Post Comment</button>
			</form>
		</div>

		<div class="ui divider mt2"></div>

		<!-- comments -->
		<div id="comments">

			<!-- comments container -->
			<div id="comments-container" class="ui comments"></div>
			<button id="load-more-comments" class="ui secondary button">Load older comments ...</button>

			<!-- empty -->
			<div id="no-comments" class="ui placeholder pv10 tac segment">
				<div class="ui icon header">
					<i class="frown icon"></i>
					We don't have any Comments for this Ticket
				</div>
				<a href="#comment-reply-form" class="ui primary small button">Be the First</a>
			</div>
		</div>

		<a href="#comment-reply-form" class="mv1">Leave a comment</a>
		<div class="ui container horizontal divider header">
		  <i class="meh icon"></i> Looks like you've reached the end
		</div>
	</div>

	<!-- include errors / delete modal -->
	{% include 'tickets/partials/ticket-delete-item.html' %}
	{% include 'tickets/partials/ticket-error-occurred.html' %}
{% endblock %}
{% block javascript %}
	<script src="{%  static 'tickets/js/ticket-api.js' %}"></script>
	<script src="{%  static 'comments/js/comment-api.js' %}"></script>
{% endblock %}